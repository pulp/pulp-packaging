From f63c0575363c16b4c0267792f321edf48c9ccc15 Mon Sep 17 00:00:00 2001
From: Grant Gainey <ggainey@redhat.com>
Date: Thu, 5 Nov 2020 15:13:41 -0500
Subject: [PATCH] Revert mkdir() changes for Bundle and Lock.

fixes #7803
---
 common/pulp/common/bundle.py | 4 ++--
 common/pulp/common/lock.py   | 5 ++---
 2 files changed, 4 insertions(+), 5 deletions(-)

diff --git a/common/pulp/common/bundle.py b/common/pulp/common/bundle.py
index be178b0061..6ad95d498b 100644
--- a/common/pulp/common/bundle.py
+++ b/common/pulp/common/bundle.py
@@ -1,7 +1,6 @@
 import os
 import re
 from logging import getLogger
-from pulp.plugins.util import misc
 
 from M2Crypto import X509
 
@@ -200,7 +199,8 @@ def mkdir(self):
         Ensure I{root} directory exists.
         """
         path = os.path.dirname(self.path)
-        misc.mkdir(path)
+        if not os.path.exists(path):
+            os.makedirs(path)
 
     def cn(self):
         """
diff --git a/common/pulp/common/lock.py b/common/pulp/common/lock.py
index 9caf9b1c7c..7fdf7e9b8f 100644
--- a/common/pulp/common/lock.py
+++ b/common/pulp/common/lock.py
@@ -7,8 +7,6 @@
 
 from threading import RLock
 
-from pulp.plugins.util import misc
-
 
 class LockFailed(Exception):
     pass
@@ -94,7 +92,8 @@ def setpid(self, pid=os.getpid()):
 
     def __mkdir(self, path):
         dir = os.path.dirname(path)
-        misc.mkdir(dir)
+        if not os.path.exists(dir):
+            os.makedirs(dir)
 
 
 class Lock:
